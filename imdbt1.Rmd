---
title: "IMDB Analysis"
author: "Julian Villar"
date: "17 July 2018"
output:
html_notebook: 
    df_print: paged
number_sections: yes
mathjax: null
theme: spacelab
highlight: tango
---

# Are movies getting better?
## Introduction
introduction here

## Tools used 
```{r warning=FALSE, message=FALSE}
library(tidyverse)
library(ggrepel)
library(gghighlight)
library(ggridges)
library(tidytext)
library(readr)
library(scales)
library(knitr)
```



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



## Ratings
```{r echo=FALSE, error=FALSE, warning=FALSE, message=FALSE}
read_imdb = function(data_path) {
  path = "C:/Users/Jewlian/Documents/SQL_R_Python/R/IMDB_Project/"
  read_tsv(paste0(path, data_path), na = "\\N", progress=F)
}
df_ratings = read_imdb("title.ratings.tsv")
df_ratings %>% head()
```
We begin by plotting the average rating of all movies.
```{r echo=FALSE, error=FALSE, warning=FALSE, message=FALSE}
plot <- ggplot(df_ratings, aes(x = numVotes, y = averageRating)) +
          geom_bin2d() +
          scale_x_log10(labels = comma) +
          scale_y_continuous(breaks = 1:10) +
          scale_fill_viridis_c(labels = comma) +
          labs(x="Number of Votes", y="Average Rating", title="Average IMBd rating and how many people vote that way")

ggsave("imdb-1.png", plot, width=4, height=3)
plot(plot)

```

## Expanding our dataset 
```{r echo=FALSE, error=FALSE, warning=FALSE, message=FALSE}
df_basics = read_imdb("title.basics.tsv")
```
Now this extensive dataset is added, we'll combine them
```{r echo=FALSE, error=FALSE, warning=FALSE, message=FALSE}
df_ratings <- df_ratings %>% left_join(df_basics)
head(df_ratings)
```
Now with our new extensive data frame we move to perform the real analysis. 
```{r echo=FALSE, error=FALSE, warning=FALSE, message=FALSE}
plot1 <- ggplot(df_ratings %>% filter(titleType == "movie", numVotes >= 10), aes(x = startYear, y = averageRating)) +
          geom_bin2d() +
          geom_smooth(color="black") +
          scale_x_continuous() +
          scale_y_continuous(breaks = 1:10) +
          scale_fill_viridis_c(option = "plasma", labels = comma, trans = 'log10') +
          labs(title="Average movie ratings for all genres")
plot(plot1)
ggsave("imdb-2.png", plot1, width=4, height=3)
```



Making a subset was the first challenge, this is as follos 
```{r}
df_ratingsHORROR = subset(df_ratings, grepl("Horror", genres))
```

```{r echo=FALSE, error=FALSE, warning=FALSE, message=FALSE}
plot2 <- ggplot(df_ratingsHORROR %>% filter(titleType == "movie", numVotes >= 10), aes(x = startYear, y = averageRating)) +
          geom_bin2d() +
          geom_smooth(color="black") +
          scale_x_continuous() +
          scale_y_continuous(breaks = 1:10) +
          scale_fill_viridis_c(option = "plasma", labels = comma, trans = 'log10') + 
          labs(title="Horror movie ratings throughout time")
ggsave("imdb-3.png", plot2, width=4, height=3)
plot(plot2)

```
As previously done for Horror we will now recreate for Comedy
```{r}
df_ratingsCOMEDY = subset(df_ratings, grepl("Comedy", genres))
```
might be error here pls no
```{r echo=FALSE, error=FALSE, warning=FALSE, message=FALSE}
plot3 <- ggplot(df_ratingsCOMEDY %>% filter(titleType == "movie", numVotes >= 10), aes(x = startYear, y = averageRating)) +
          geom_bin2d() +
          geom_smooth(color="black") +
          scale_x_continuous() +
          scale_y_continuous(breaks = 1:10) +
          scale_fill_viridis_c(option = "plasma", labels = comma, trans = 'log10') + 
          labs(title="Comedy movie ratings throughout time")
ggsave("imdb-4.png", plot3, width=4, height=3)
plot(plot3)

```
